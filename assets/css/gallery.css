fetch('assets/gallery/gallery.json')
  .then(response => response.json())
  .then(data => {
    const galleryContainer = document.getElementById('gallery');

    data.albums.forEach(album => {
      const albumDiv = document.createElement('div');
      albumDiv.classList.add('album');

      const title = document.createElement('h2');
      title.textContent = album.title;
      albumDiv.appendChild(title);

      // Placeholder div for images
      const imagesDiv = document.createElement('div');
      imagesDiv.classList.add('images');
      albumDiv.appendChild(imagesDiv);

      galleryContainer.appendChild(albumDiv);

      let imagesLoaded = false;

      title.addEventListener('click', () => {
        const isActive = albumDiv.classList.contains('active');
        document.querySelectorAll('.album').forEach(a => a.classList.remove('active', 'minimized'));

        if (!isActive) {
          albumDiv.classList.add('active');
          document.querySelectorAll('.album').forEach(a => {
            if (a !== albumDiv) a.classList.add('minimized');
          });

          // Only load images once
          if (!imagesLoaded) {
            album.images.forEach(img => {
              const imgElement = document.createElement('img');
              imgElement.src = `assets/gallery/${album.folder}/${img}`;
              imgElement.alt = `${album.title} - ${img}`;
              imgElement.loading = "lazy";
              imagesDiv.appendChild(imgElement);
            });
            imagesLoaded = true;
          }
        }
      });
    });
  })
  .catch(error => console.error("Error loading gallery:", error));

.gallery-button-container {
  text-align: center;
  margin: 3rem 0;
}

.gallery-btn {
  display: inline-block;
  padding: 1rem 2rem;
  border: 2px solid #00ffff;
  color: #00ffff;
  text-decoration: none;
  font-family: "Orbitron", sans-serif;
  font-size: 1.2rem;
  border-radius: 8px;
  text-shadow: 0 0 10px #00ffff;
  transition: all 0.3s ease;
}

.gallery-btn:hover {
  background-color: #00ffff;
  color: #0d0d0d;
  box-shadow: 0 0 20px #00ffff;
}
